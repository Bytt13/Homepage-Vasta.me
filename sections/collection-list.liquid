{% comment %} ---- CSS ---- {% endcomment %}
<style>
    .collection-list-wrapper {
        padding: 50px 0;
        background-color: {{ section.settings.background_color }};
    }

    .collection-list-header {
        text-align: center;
        margin-bottom: 40px;
    }

    .collection-list-title {
        font-size: 36px;
        font-weight: bold;
        color: {{ section.settings.title_color }};
    }

    .collection-list-swiper {
        max-width: 1300px; 
        margin: 0 auto;
        position: relative; 
    }

    .collection-card {
        position: relative;
        width: 243px;
        height: 363px;
        border-radius: 13px;
        overflow: hidden;
        color: white;
        text-decoration: none;
        display: block;
    }

    .collection-card-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
    }

    .collection-card:hover .collection-card-image {
        transform: scale(1.05);
    }

    .collection-card-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0) 50%);
        display: flex;
        align-items: flex-end;
        padding: 20px;
    }

    .collection-card-title {
        font-size: 24px;
        font-weight: 500;
    }

    .collection-list-swiper .swiper-button-prev,
    .collection-list-swiper .swiper-button-next {
        background: rgba(200,200,200,0.25);
        backdrop-filter: blur(10px);
        border: none;
        border-radius: 50%;
        width: 46px;ß
        height: 46px; 
        transition: transform 0.2s ease;
    }

    .collection-list-swiper .swiper-button-prev:hover,
    .collection-list-swiper .swiper-button-next:hover {
        transform: scale(1.1);
    }
    
    .collection-list-swiper .swiper-button-prev::after,
    .collection-list-swiper .swiper-button-next::after {
        display: none;
    }
    
</style>

{% comment %} ---- HTML ---- {% endcomment %}
<div class="collection-list-wrapper">
    <div class="collection-list-header">
        {% if section.settings.title != blank %}
            <h2 class="collection-list-title">{{ section.settings.title | escape }}</h2>
        {% endif %}
    </div>

    <div class="swiper collection-list-swiper">
        <div class="swiper-wrapper">
            {% for block in section.blocks %}
                <div class="swiper-slide">
                    <a href="{{ block.settings.collection.url | default: '#' }}" class="collection-card">
                        {% if block.settings.image != blank %}
                            <img src="{{ block.settings.image | image_url: width: 486 }}" alt="{{ block.settings.image.alt | default: block.settings.collection.title }}" class="collection-card-image" loading="lazy" width="243" height="363">
                        {% elsif block.settings.collection.image != blank %}
                            <img src="{{ block.settings.collection.image | image_url: width: 486 }}" alt="{{ block.settings.collection.title }}" class="collection-card-image" loading="lazy" width="243" height="363">
                        {% else %}
                            <img src="{{ 'c7f13605799103bd8e28d91a9bb9f04b06563998.png' | asset_url }}" alt="Imagem padrão da coleção" class="collection-card-image" loading="lazy" width="243" height="363">
                        {% endif %}
                        <div class="collection-card-overlay">
                            <h3 class="collection-card-title">{{ block.settings.collection.title | default: "Lorem Ipsum" }}</h3>
                        </div>
                    </a>
                </div>
            {% endfor %}
        </div>

        <div class="swiper-button-prev">
            <svg width="46" height="46" viewBox="0 0 46 46" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g><rect x="46" y="46" width="46" height="46" rx="23" transform="rotate(-180 46 46)" fill="white" fill-opacity="0.25"/><rect x="44.6757" y="44.6757" width="43.3514" height="43.3514" rx="21.6757" transform="rotate(-180 44.6757 44.6757)" stroke="white" stroke-opacity="0.5" stroke-width="2.64862"/><path d="M28.7497 23.0005L17.2497 23.0005M17.2497 23.0005L22.9997 28.7505M17.2497 23.0005L22.9997 17.2505" stroke="white" stroke-width="1.64286" stroke-linecap="round" stroke-linejoin="round"/></g>
            </svg>
        </div>
        <div class="swiper-button-next">
            <svg width="46" height="46" viewBox="0 0 46 46" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g><rect width="46" height="46" rx="23" fill="white" fill-opacity="0.25"/><rect x="1.32431" y="1.32431" width="43.3514" height="43.3514" rx="21.6757" stroke="white" stroke-opacity="0.5" stroke-width="2.64862"/><path d="M17.2503 22.9995H28.7503M28.7503 22.9995L23.0003 17.2495M28.7503 22.9995L23.0003 28.7495" stroke="white" stroke-width="1.64286" stroke-linecap="round" stroke-linejoin="round"/></g>
            </svg>
        </div>
    </div>
</div>

{% comment %} ---- JAVASCRIPT ---- {% endcomment %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Inicializa o Swiper
    const swiper = new Swiper('.collection-list-swiper', {
      // Opções do Swiper
      loop: true,
      slidesPerView: 'auto',
      centeredSlides: true,
      spaceBetween: 30,

      // Navegação por setas
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },


      breakpoints: {
        320: {
          slidesPerView: 1.2,
          spaceBetween: 15,
          centeredSlides: true,
        },
        768: {
          slidesPerView: 2.5,
          spaceBetween: 20,
          centeredSlides: false,
        },
        1024: {
          slidesPerView: 4,
          spaceBetween: 15,
          centeredSlides: false,
        },
        1280: {
          slidesPerView: 5,
          spaceBetween: 22,
          centeredSlides: false,
        }
      }
    });
  });
</script>

{% comment %} ---- SCHEMA ---- {% endcomment %}
{% schema %}
    {
      "name": "Lista de Coleções",
      "settings": [
        { "type": "text", "id": "title", "label": "Título da Seção", "default": "Shop by Collection" },
        { "type": "color", "id": "background_color", "label": "Cor de Fundo", "default": "#FFFFFF" },
        { "type": "color", "id": "title_color", "label": "Cor do Título", "default": "#000000" }
      ],
      "blocks": [
        {
          "type": "collection",
          "name": "Coleção",
          "settings": [
            { "type": "collection", "id": "collection", "label": "Selecione a Coleção" },
            { "type": "image_picker", "id": "image", "label": "Imagem Personalizada (Opcional)", "info": "Substitui a imagem padrão da coleção. Use uma imagem com proporção aproximada de 243x363." }
          ]
        }
      ],
      "presets": [
        {
          "name": "Lista de Coleções (com Swiper)",
          "blocks": [
            { "type": "collection" },
            { "type": "collection" },
            { "type": "collection" },
            { "type": "collection" },
            { "type": "collection" },
            { "type": "collection" }
          ]
        }
      ]
    }
{% endschema %}